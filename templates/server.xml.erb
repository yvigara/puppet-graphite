<?xml version='1.0' encoding='utf-8'?>
<!-- AUTOGENERATED BY PUPPET -->

<Server port="<%- if @shutdown_port and not @shutdown_port.empty? -%><%= @shutdown_port %><%- else -%>8095<%- end -%>" shutdown="SHUTDOWN">

  <!--APR library loader. Documentation at /docs/apr.html -->
  <Listener className="org.apache.catalina.core.AprLifecycleListener" SSLEngine="on" />

  <!--Initialize Jasper prior to webapps are loaded. Documentation at /docs/jasper-howto.html -->
  <Listener className="org.apache.catalina.core.JasperListener" />

  <!-- JMX Support for the Tomcat server. Documentation at /docs/non-existent.html -->
  <!-- ServerLifeCycleListener has been removed in Tomcat 7.0.9
       See http://tomcat.apache.org/tomcat-7.0-doc/changelog.html for more information.
  <Listener className="org.apache.catalina.mbeans.ServerLifecycleListener" />  -->
  <Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener" />

  <!-- Prevent memory leaks due to use of particular java/javax APIs-->
  <Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener" />

  <GlobalNamingResources>
    <Resource name="UserDatabase" auth="Container" type="org.apache.catalina.UserDatabase"
              description="User database that can be updated and saved"
              factory="org.apache.catalina.users.MemoryUserDatabaseFactory"
              pathname="conf/tomcat-users.xml" />
  </GlobalNamingResources>

  <Service name="Catalina">

     <Connector port="<%- if @http_port and not @http_port.empty? -%><%= @http_port %><%- else -%>8080<%- end -%>"
                protocol="org.apache.coyote.http11.Http11NioProtocol"
                maxThreads="<%- if @max_threads and not @max_threads.empty? -%><%= @max_threads %><%- else -%>200<%- end -%>"
                acceptCount="<%- if @accept_count and not @accept_count.empty? -%><%= @accept_count %><%- else -%>100<%- end -%>"
                connectionTimeout="<%- if @connection_timeout and not @connection_timeout.empty? -%><%= @connection_timeout %><%- else -%>20000<%- end -%>"
                processorCache="<%- if @processor_cache and not @processor_cache.empty? -%><%= @processor_cache %><%- else -%>200<%- end -%>"
                maxKeepAliveRequests="<%- if @max_keep_alive_requests and not @max_keep_alive_requests.empty? -%><%= @max_keep_alive_requests %><%- else -%>100<%- end -%>"
                server="Apache Tomcat"
                xpoweredby="false"
                redirectPort="<%- if @https_port and not @https_port.empty? -%><%= @https_port %><%- else -%>8443<%- end -%>" />

    <Engine name="Catalina" defaultHost="localhost" >

      <Realm className="org.apache.catalina.realm.UserDatabaseRealm" resourceName="UserDatabase"/>

      <!-- Define the default virtual host
        Note: XML Schema validation will not work with Xerces 2.2.
      -->
      <Host name="localhost"  appBase="webapps"  unpackWARs="true" autoDeploy="false" xmlValidation="false" xmlNamespaceAware="false">

        <Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"
               prefix="access." suffix=".log" resolveHosts="false"
               pattern="%h %u %t %r %s %b %D %S %I" />

      </Host>
    </Engine>
  </Service>
</Server>

